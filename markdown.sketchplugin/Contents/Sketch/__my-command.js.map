{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/my-command.js","webpack://exports/external \"sketch\""],"names":["sketch","require","console","log","context","selection","selection1","selection2","getSelectedDocument","selectedLayers","layers","length","UI","message","text","LayerTextArr","recordQueryIndex","i","class","split","setLineHeight","frame","setWidth","sketchObject","addAttribute_value_forRange","NSStrikethroughStyleAttributeName","NSUnderlineStyleNone","NSMakeRange","UnoldFont","NSFontManager","sharedFontManager","convertFont_toHaveTrait","font","NSUnboldFontMask","addAttribute_value_forRange_","NSFontAttributeName","immutableColor","MSImmutableColor","colorWithSVGString_","color","MSColor","alloc","initWithImmutableObject_","setTextColor","j","main","underArr","boldArr","indexOf","push","k","NSUnderlineStyleSingle","h1BoldFont","NSBoldFontMask","m","rowStr","layer","markEnd","keyValue","strInAllStart","strInAllEnd","substring","setHeading1","setHeading2","setDesc","start","end","h1FontSize","convertFont_toSize","h2BoldFont","h2FontSize","descBoldFont","descFontSize"],"mappings":"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","file":"__my-command.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/my-command.js\");\n","var sketch = require('sketch')\n\nexport default function () {\n\n\n  console.log(context.selection)\n  var selection1 = context.selection //当前选中图层的数组，用于设置样式\n  var selection2 = sketch.getSelectedDocument().selectedLayers.layers//当前选中图层的数组，长度与 selection1 是一样的，用于解析每行的字符串\n\n  if (selection2.length == 0) {\n    sketch.UI.message('⚠️请先选中文本');\n    return\n  }\n\n  console.log(selection2[0].text)\n  var LayerTextArr\n  var recordQueryIndex = 0;\n\n  //const h2BoldFont = NSFontManager.sharedFontManager().convertFont_toHaveTrait(selection2[0].sketchObject.font(), NSUnderlineStyleSingle);\n  //layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName,h2BoldFont, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n  //selection2[0].sketchObject.addAttribute_value_forRange(NSStrikethroughStyleAttributeName, NSUnderlineStyleSingle, NSMakeRange(0, 4)); // NSMakeRange 定义设置样式文字位置\n\n\n  //selection1[0].addAttribute_value_forRange_(NSFontAttributeName,tFontSize, NSMakeRange(5, 4));\n  //selection1[0].addAttribute_value_forRange_(NSFontAttributeName,boldFont, NSMakeRange(5, 4));\n\n  for (var i = 0; i < selection2.length; i++) {\n    recordQueryIndex = 0\n    //return\n    //console.log(layer.stringValue())\n    console.log(\"=============================i: \")\n    console.log(i)\n    if (selection1[i].class() != \"MSTextLayer\") {\n      console.log('selection1[i].class()!=\"MSTextLayer\"')\n      continue\n    }\n    LayerTextArr = selection2[i].text.split(\"\\n\") //将文本段落按行进行拆分，获得一个每行字符串的数组\n    console.log(\"LayerTextArr: \")\n    console.log(LayerTextArr)\n    console.log(selection1[i].class())\n\n    selection1[i].setLineHeight(24)\n    selection1[i].frame().setWidth(375)\n\n    //初始化加粗、删除线样式\n    selection2[i].sketchObject.addAttribute_value_forRange(NSStrikethroughStyleAttributeName, NSUnderlineStyleNone, NSMakeRange(0, selection2[i].text.length)); // NSMakeRange 定义设置样式文字位置\n    var UnoldFont = NSFontManager.sharedFontManager().convertFont_toHaveTrait(selection2[i].sketchObject.font(), NSUnboldFontMask);\n    selection2[i].sketchObject.addAttribute_value_forRange_(NSFontAttributeName, UnoldFont, NSMakeRange(0, selection2[i].text.length)); // NSMakeRange 定义设置样式文字位置\n\n    var immutableColor = MSImmutableColor.colorWithSVGString_('#333333');\n    var color = MSColor.alloc().initWithImmutableObject_(immutableColor);\n    selection1[i].setTextColor(color)\n\n    for (var j = 0; j < LayerTextArr.length; j++) {\n      //处理每行字符串的样式,传入单行字符串、此图层的文本段落\n      console.log(\"==========\")\n      //console.log(selection1[i].stringValue())\n      console.log(\"LayerTextArr[j]: \")\n      console.log(LayerTextArr[j])\n      //main(LayerTextArr[j],selection2[i])\n      selection2[i] = main(LayerTextArr[j], selection2[i])\n\n    }\n\n    var underArr = []\n    var boldArr = []\n    console.log(\"~~~~\")\n\n    recordQueryIndex = 0\n    //删除线\n    while (selection2[i].text.indexOf('~~', recordQueryIndex) != -1) {\n\n      console.log(selection2[i].text.indexOf('~~', recordQueryIndex))\n      underArr.push(selection2[i].text.indexOf('~~', recordQueryIndex))\n      recordQueryIndex = selection2[i].text.indexOf('~~', recordQueryIndex) + 1\n\n    }\n    console.log(underArr)\n    if (underArr.length > 1) {\n      for (var k = 0; k < underArr.length; k++) {\n        if (underArr.length - k == 1) {\n          break;\n        }\n        //const h2BoldFont = NSFontManager.sharedFontManager().convertFont_toHaveTrait(selection2[i].sketchObject.font(), NSUnderlineStyleSingle);\n        selection2[i].sketchObject.addAttribute_value_forRange(NSStrikethroughStyleAttributeName, NSUnderlineStyleSingle, NSMakeRange(underArr[k], underArr[k + 1] - underArr[k] + 2)); // NSMakeRange 定义设置样式文字位置\n        k+=1\n      }\n    }\n\n\n    recordQueryIndex = 0\n    //加粗\n    console.log(\"**********\")\n    var h1BoldFont = NSFontManager.sharedFontManager().convertFont_toHaveTrait(selection2[i].sketchObject.font(), NSBoldFontMask);\n    while (selection2[i].text.indexOf('**', recordQueryIndex) != -1) {\n\n      console.log(selection2[i].text.indexOf('**', recordQueryIndex))\n      boldArr.push(selection2[i].text.indexOf('**', recordQueryIndex))\n      recordQueryIndex = selection2[i].text.indexOf('**', recordQueryIndex) + 1\n\n    }\n    console.log(boldArr)\n    if (boldArr.length > 1) {\n      for (var m = 0; m < boldArr.length; m++) {\n        if (boldArr.length - m == 1) {\n          break;\n        }\n        selection2[i].sketchObject.addAttribute_value_forRange_(NSFontAttributeName, h1BoldFont, NSMakeRange(boldArr[m], boldArr[m + 1] - boldArr[m] + 2)); // NSMakeRange 定义设置样式文字位置\n        m += 1  \n      }\n    }\n\n\n  }\n\n  //selectionLayer.stringValue())\n\n  //console.log(selection.length)\n  //console.log(sketch.getSelectedDocument().selectedLayers.length)\n\n\n  function main(rowStr, layer) {\n    var markEnd\n    var keyValue\n    var strInAllStart, strInAllEnd\n\n    markEnd = rowStr.indexOf(' ')\n    keyValue = rowStr.substring(0, markEnd)\n    console.log(\"rowStr: \" + rowStr)\n    console.log(\"keyValue: \" + keyValue)\n\n    //find thisStr in allStr index\n    strInAllStart = layer.text.indexOf(rowStr, recordQueryIndex)\n    if (strInAllStart != 0) {\n      //strInAllStart+=2\n    }\n    //console.log(\"layer.stringValue(): \"+layer.stringValue().replace(/\\n/g,\"\"))\n    console.log(\"layer.stringValue(): \" + layer.text)\n    strInAllEnd = rowStr.length\n    recordQueryIndex += rowStr.length\n    console.log(\"start,end: \")\n    console.log(strInAllStart)\n    console.log(strInAllEnd)\n\n    switch (keyValue) {\n      case \"#\":\n        layer = setHeading1(layer, strInAllStart, strInAllEnd)\n        break;\n      case \"##\":\n        layer = setHeading2(layer, strInAllStart, strInAllEnd)\n        break;\n      default:\n        layer = setDesc(layer, strInAllStart, strInAllEnd)\n    }\n    return layer\n  }\n\n\n  function setHeading1(layer, start, end) {\n    console.log('setHeading1')\n    //layer = layer.sketchObject\n    //fontSize\n    console.log(start)\n    console.log(end)\n    console.log(layer.text)\n    console.log(\"------\")\n    console.log(layer.text.substring(start, start + end))\n\n    //layer = layer.sketchObject\n\n    const h1BoldFont = NSFontManager.sharedFontManager().convertFont_toHaveTrait(layer.sketchObject.font(), NSBoldFontMask);\n    //layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName,h1BoldFont, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n    const h1FontSize = NSFontManager.sharedFontManager().convertFont_toSize(h1BoldFont, 14.0);\n    layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName, h1FontSize, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n\n    return layer\n  }\n\n  function setHeading2(layer, start, end) {\n    console.log('setHeading2')\n    console.log(start)\n    console.log(end)\n    console.log(\"layer.stringValue().substring(start,start+end): \")\n    console.log(layer.text)\n    console.log(\"------\")\n    console.log(layer.text.substring(start, start + end))\n\n    //layer = layer.sketchObject\n\n    const h2BoldFont = NSFontManager.sharedFontManager().convertFont_toHaveTrait(layer.sketchObject.font(), NSBoldFontMask);\n    //layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName,h2BoldFont, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n    const h2FontSize = NSFontManager.sharedFontManager().convertFont_toSize(h2BoldFont, 14.0);\n    layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName, h2FontSize, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n\n\n\n    return layer\n\n  }\n\n  function setDesc(layer, start, end) {\n    console.log('setDesc')\n    console.log(layer.text)\n    console.log(\"------\")\n    console.log(layer.text.substring(start, start + end))\n    //layer = layer.sketchObject\n\n    const descBoldFont = NSFontManager.sharedFontManager().convertFont_toHaveTrait(layer.sketchObject.font(), NSUnboldFontMask);\n    layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName, descBoldFont, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n    const descFontSize = NSFontManager.sharedFontManager().convertFont_toSize(descBoldFont, 14.0);\n    layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName, descFontSize, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n    //layer.sketchObject.addAttribute_value_forRange_(NSFontAttributeName,descBoldFont, NSMakeRange(start, end)); // NSMakeRange 定义设置样式文字位置\n\n\n    return layer\n  }\n}","module.exports = require(\"sketch\");"],"sourceRoot":""}